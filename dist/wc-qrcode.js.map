{"version":3,"file":"wc-qrcode.js","mappings":"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","sources":["webpack://wc-qrcode/webpack/universalModuleDefinition","webpack://wc-qrcode/./node_modules/@yishiashia/wasm-qrcode/wasm_qrcode.js","webpack://wc-qrcode/./src/QRCode.ts","webpack://wc-qrcode/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"wc-qrcode\"] = factory();\n\telse\n\t\troot[\"wc-qrcode\"] = factory();\n})(self, () => {\nreturn ","\nlet wasm;\n\nlet WASM_VECTOR_LEN = 0;\n\nlet cachedUint8Memory0 = new Uint8Array();\n\nfunction getUint8Memory0() {\n    if (cachedUint8Memory0.byteLength === 0) {\n        cachedUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachedUint8Memory0;\n}\n\nconst cachedTextEncoder = new TextEncoder('utf-8');\n\nconst encodeString = (typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n    return cachedTextEncoder.encodeInto(arg, view);\n}\n    : function (arg, view) {\n    const buf = cachedTextEncoder.encode(arg);\n    view.set(buf);\n    return {\n        read: arg.length,\n        written: buf.length\n    };\n});\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length);\n        getUint8Memory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len);\n\n    const mem = getUint8Memory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3);\n        const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n        const ret = encodeString(arg, view);\n\n        offset += ret.written;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n\nlet cachedInt32Memory0 = new Int32Array();\n\nfunction getInt32Memory0() {\n    if (cachedInt32Memory0.byteLength === 0) {\n        cachedInt32Memory0 = new Int32Array(wasm.memory.buffer);\n    }\n    return cachedInt32Memory0;\n}\n\nconst cachedTextDecoder = new TextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n\ncachedTextDecoder.decode();\n\nfunction getStringFromWasm0(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n/**\n* @param {string} arg\n* @param {number} width\n* @param {number} height\n* @returns {string}\n*/\nexport function qrcode(arg, width, height) {\n    try {\n        const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n        const ptr0 = passStringToWasm0(arg, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n        const len0 = WASM_VECTOR_LEN;\n        wasm.qrcode(retptr, ptr0, len0, width, height);\n        var r0 = getInt32Memory0()[retptr / 4 + 0];\n        var r1 = getInt32Memory0()[retptr / 4 + 1];\n        return getStringFromWasm0(r0, r1);\n    } finally {\n        wasm.__wbindgen_add_to_stack_pointer(16);\n        wasm.__wbindgen_free(r0, r1);\n    }\n}\n\n/**\n* @param {string} arg\n* @param {number} width\n* @param {number} height\n* @returns {string}\n*/\nexport function qrcode_base64(arg, width, height) {\n    try {\n        const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n        const ptr0 = passStringToWasm0(arg, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n        const len0 = WASM_VECTOR_LEN;\n        wasm.qrcode_base64(retptr, ptr0, len0, width, height);\n        var r0 = getInt32Memory0()[retptr / 4 + 0];\n        var r1 = getInt32Memory0()[retptr / 4 + 1];\n        return getStringFromWasm0(r0, r1);\n    } finally {\n        wasm.__wbindgen_add_to_stack_pointer(16);\n        wasm.__wbindgen_free(r0, r1);\n    }\n}\n\nasync function load(module, imports) {\n    if (typeof Response === 'function' && module instanceof Response) {\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            try {\n                return await WebAssembly.instantiateStreaming(module, imports);\n\n            } catch (e) {\n                if (module.headers.get('Content-Type') != 'application/wasm') {\n                    console.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\n                } else {\n                    throw e;\n                }\n            }\n        }\n\n        const bytes = await module.arrayBuffer();\n        return await WebAssembly.instantiate(bytes, imports);\n\n    } else {\n        const instance = await WebAssembly.instantiate(module, imports);\n\n        if (instance instanceof WebAssembly.Instance) {\n            return { instance, module };\n\n        } else {\n            return instance;\n        }\n    }\n}\n\nfunction getImports() {\n    const imports = {};\n    imports.wbg = {};\n\n    return imports;\n}\n\nfunction initMemory(imports, maybe_memory) {\n\n}\n\nfunction finalizeInit(instance, module) {\n    wasm = instance.exports;\n    init.__wbindgen_wasm_module = module;\n    cachedInt32Memory0 = new Int32Array();\n    cachedUint8Memory0 = new Uint8Array();\n\n\n    return wasm;\n}\n\nfunction initSync(module) {\n    const imports = getImports();\n\n    initMemory(imports);\n\n    if (!(module instanceof WebAssembly.Module)) {\n        module = new WebAssembly.Module(module);\n    }\n\n    const instance = new WebAssembly.Instance(module, imports);\n\n    return finalizeInit(instance, module);\n}\n\nasync function init(input) {\n    if (typeof input === 'undefined') {\n        input = new URL('wasm_qrcode_bg.wasm', import.meta.url);\n    }\n    const imports = getImports();\n\n    if (typeof input === 'string' || (typeof Request === 'function' && input instanceof Request) || (typeof URL === 'function' && input instanceof URL)) {\n        input = fetch(input);\n    }\n\n    initMemory(imports);\n\n    const { instance, module } = await load(await input, imports);\n\n    return finalizeInit(instance, module);\n}\n\nexport { initSync }\nexport default init;\n","import wasm_init, { qrcode, qrcode_base64 } from \"@yishiashia/wasm-qrcode\"\n\nexport default class QRCode extends HTMLElement {\n\n  private props: {\n    alt: string\n    text: string\n    size: number\n  }\n  private qrimg: string | null\n\n  static get observedAttributes() {\n    return [\"text\", \"size\"];\n  }\n\n  constructor () {\n    super()\n    this.attachShadow({ mode: 'open' })\n\n    this.props = {\n      alt: '',\n      text: '',\n      size: 6\n    }\n    this.qrimg = null\n  }\n\n  async connectedCallback () {\n    await wasm_init()\n    if (this.shadowRoot !== null) {\n      this.setupProps()\n      this.setupDom()\n      this.setupStyle()\n      this.setupListenEvents()\n    }\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (name === \"text\") {\n      this.props.text = newValue\n      this.qrimg = qrcode_base64(this.props.text, 36, 36)\n      this.refreshQRImage()\n    } else if (name === \"size\") {\n      const size = parseInt(newValue)\n      this.props.size = !isNaN(size) && size > 0 ? size : this.props.size\n      this.refreshQRImage()\n    }\n  }\n\n  disconnectedCallback () {\n\n  }\n\n  setupProps () {\n    if (this.hasAttribute(\"text\")) {\n      this.props.text = String(this.getAttribute(\"text\"))\n      this.props.alt = String(this.getAttribute(\"text\"))\n      this.qrimg = qrcode_base64(this.props.text, 36, 36)\n    }\n    if (this.hasAttribute(\"alt\")) {\n      const alt = String(this.getAttribute(\"alt\")).trim()\n      if (alt !== \"\") { this.props.alt = alt }\n    }\n    if (this.hasAttribute(\"size\")) {\n      const size = parseInt(String(this.getAttribute(\"size\")))\n      if (!isNaN(size) && size > 0) { this.props.size = size }\n    }\n  }\n\n  setupDom () {\n    if (this.shadowRoot !== null) {\n      this.shadowRoot.innerHTML = this.template(this.props)\n    }\n  }\n\n  setupStyle () {\n\n  }\n\n  setupListenEvents () {\n\n  }\n\n  refreshQRImage () {\n    if (this.shadowRoot !== null) {\n      let img = this.shadowRoot.querySelector('img')\n      if (img === null) {\n        img = document.createElement('img')\n        img.style.cssText = `\n          width: ${this.props.size * 16}px;\n          height: ${this.props.size * 16}px;\n        `\n        this.shadowRoot.querySelector('.qrcode-container')?.appendChild(img)\n      }\n      if (img !== null && this.qrimg !== null) {\n        img.src = `data:image/svg+xml;base64,${this.qrimg}`\n        img.alt = this.props.alt\n      }\n    }\n  }\n\n  template (data: {\n    alt: string\n    text: string\n    size: number\n  }) {\n    return `\n      <div class=\"qrcode-container\">\n        ${\n          this.qrimg === null ? \"\" : `\n            <img\n              src=\"data:image/svg+xml;base64,${this.qrimg}\"\n              alt=\"${data.alt}\"\n              style=\"width: ${data.size * 16}px; height: ${data.size * 16}px;\" />`\n        }\n      </div>\n    `.trim()\n  }\n}","import QRCode from \"./QRCode\";\n\n// Register custom elements\nif(customElements.get('qr-code') === undefined) {\n  window.customElements.define('qr-code', QRCode)\n}\n\nexport default QRCode"],"names":["root","factory","exports","module","define","amd","self","wasm","WASM_VECTOR_LEN","cachedUint8Memory0","Uint8Array","getUint8Memory0","byteLength","memory","buffer","cachedTextEncoder","TextEncoder","encodeString","encodeInto","arg","view","buf","encode","set","read","length","written","cachedInt32Memory0","Int32Array","getInt32Memory0","cachedTextDecoder","TextDecoder","ignoreBOM","fatal","qrcode_base64","width","height","retptr","__wbindgen_add_to_stack_pointer","ptr0","malloc","realloc","undefined","ptr","subarray","len","mem","offset","code","charCodeAt","slice","passStringToWasm0","__wbindgen_malloc","__wbindgen_realloc","len0","r0","r1","decode","__wbindgen_free","async","init","input","URL","imports","Request","fetch","instance","Response","WebAssembly","instantiateStreaming","e","headers","get","console","warn","bytes","arrayBuffer","instantiate","Instance","load","__wbindgen_wasm_module","finalizeInit","QRCode","attachShadow","mode","props","alt","text","size","qrimg","wasm_init","this","shadowRoot","setupProps","setupDom","setupStyle","setupListenEvents","name","oldValue","newValue","refreshQRImage","parseInt","isNaN","hasAttribute","String","getAttribute","trim","innerHTML","template","img","querySelector","document","createElement","style","cssText","appendChild","src","data","HTMLElement","customElements","window"],"sourceRoot":""}